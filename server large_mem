#!/bin/bash
 
# Input parameter
input_value=$1
 
# Create a network port
port_id=$(openstack port create --network ec40bccd-c7d2-4dcb-9cbd-2f0369b7dc8f --fixed-ip subnet=dc0bcb6d-c916-4b25-aaec-f5b76a6dd7ab --enable oa80_big_mem_test_${input_value} -f json | jq -r '.id')
echo $port_id
 
# Assign security groups to the port
openstack port set --security-group 17888647-defd-4a65-9500-e4bb7a2e1304 --security-group e2231818-7d83-4f0e-b470-95453cdbd869  $port_id
 
# Create a floating IP
openstack floating ip create -f json --subnet 08912802-1f16-471f-b8d1-385b36d94651 --port $port_id pro-net-vlan3160
 
# Create a volume
volume_id=$(openstack volume create -f json --type netapp_iscsi --snapshot 36748f2c-3076-4844-ba8d-5c6d2df08b3d --size 320 --bootable oa80_big_mem_test-${input_value} | jq -r '.id')
echo $volume_id
 
# Create a server
openstack server create --flavor m6.large-mem --volume $volume_id --security-group 17888647-defd-4a65-9500-e4bb7a2e1304 --security-group e2231818-7d83-4f0e-b470-95453cdbd869 --port $port_id --key-name c30-drm-keypair --wait oa80_big_mem_test-${input_value}
 
#openstack server create --flavor m6i.xlarge_nexum --volume $volume_id --security-group 6a5eb622-2c9d-4c9b-800d-baa5fe24aae3 --security-group 2b22c332-7937-4c90-a413-fabc05f89ae2 --port $port_id --key-name c30-drm-keypair --wait oa80_big_mem_test-${input_value}
 
# List the server
openstack server list | grep -i "oa80_big_mem_test"

This is a sample file to create a server inside openstack 


for all thgese values now we need to find for tn02 in test env



3eb39e89-ac62-4b5b-a313-8d52482cc1f2    - network

3eb39e89-ac62-4b5b-a313-8d52482cc1f2    - network

b3455868-8842-4b16-9f35-684e25f25f28
1320ddfd-e090-4300-8d9c-c0d10dfaf84b
	c741134d-43d3-4419-bb55-ba6e60bead75

58269c3b-bd2d-4287-aedc-2e2f2c744c19


e5db0db9-bf93-43f4-928a-e46e099fef9e -subnet

e33be8b2-02e2-41a5-87b5-830ba5d0db7a  - flaoting ip
pro-subnet-1162  - pronet vlan



e5db0db9-bf93-43f4-928a-e46e099fef9e -subnet

e33be8b2-02e2-41a5-87b5-830ba5d0db7a  - flaoting ip
pro-subnet-1162  - pronet vlan


We've set up two host aggregates to better align compute resources with workload memory requirements:
high-memory-hosts: Includes tst-overcloud-compute-01, tagged with host_type=highmem
low-memory-hosts: Includes tst-overcloud-compute-02, tagged with host_type=lowmem
To ensure proper scheduling, we've tagged relevant flavors with matching metadata:
m1.large → host_type=highmem
 c2m4 → host_type=smallmem
This configuration ensures that instances are scheduled on hosts with appropriate memory capacity
 
To test:
launch an instance with each flavor
check which compute node it is hosted on
openstack server show test-highmem-vm -f value -c OS-EXT-SRV-ATTR:host
openstack server show test-lowmem-vm -f value -c OS-EXT-SRV-ATTR:host

let me know if you have any questions
 

we need to do thsi please map[ values and give ask if any thig require sokkk












large_mem
Overview
Messages
Name
large_mem
ID
e355ab4b-a2f5-4a25-a0c8-2523816c9678
Project ID
59c2d928ef6046069a0175d74dc3dc23
Status
Available
Volume
c30-to-test-to-01-haproxy-volume
Group Snapshot
-
Specs
Size
125 GiB
Created
July 19, 2025, 1:26 a.m.
Metadata
None


so i found some values and i will gove input map those and give me the script as output i will run and see ok






✅ 1. Check Network ID and Subnet ID
Verify the network 3eb39e89-ac62-4b5b-a313-8d52482cc1f2 and subnet e5db0db9-bf93-43f4-928a-e46e099fef9e belong to tn02 test env:

bash
Copy
Edit
openstack network show 3eb39e89-ac62-4b5b-a313-8d52482cc1f2
Look for the subnets field and confirm it includes e5db0db9-bf93-43f4-928a-e46e099fef9e.

bash
Copy
Edit
openstack subnet show e5db0db9-bf93-43f4-928a-e46e099fef9e
Check its network_id matches 3eb39e89-ac62-4b5b-a313-8d52482cc1f2.

✅ 2. Check Security Groups
Run for each SG ID you plan to use:

bash
Copy
Edit
openstack security group show b3455868-8842-4b16-9f35-684e25f25f28
openstack security group show 1320ddfd-e090-4300-8d9c-c0d10dfaf84b
openstack security group show c741134d-43d3-4419-bb55-ba6e60bead75
openstack security group show 58269c3b-bd2d-4287-aedc-2e2f2c744c19
Verify they exist in the test environment project and contain the rules you expect.

✅ 3. Check Keypair
bash
Copy
Edit
openstack keypair show c30-drm-keypair
Confirm the keypair exists and belongs to your project.

✅ 4. Check Floating IP Network
bash
Copy
Edit
openstack network show pro-subnet-1162
(or if it’s pro-net-vlan3160, show that instead):

bash
Copy
Edit
openstack network list | grep pro
Confirm which is the correct external network for floating IP allocation.

✅ 5. Check Snapshot / Volume Source
bash
Copy
Edit
openstack volume show e355ab4b-a2f5-4a25-a0c8-2523816c9678
Confirm it’s in available state and has bootable: true or comes from the right source.

✅ 6. Check Flavor Extra Specs
bash
Copy
Edit
openstack flavor show m1.large
Scroll down to properties or extra_specs. Make sure you see:

ini
Copy
Edit
host_type = highmem
✅ 7. Check Aggregate Metadata and Membership
bash
Copy
Edit
openstack aggregate show high-memory-hosts
Look for:

hosts list → confirm it includes tst-overcloud-compute-02 (tn02)

properties → confirm host_type = highmem

✅ 8. (Optional) Dry Run With No Server Creation
You can test creating just the port and volume first:

bash
Copy
Edit
openstack port create --network <network-id> --fixed-ip subnet=<subnet-id> test-port-dryrun
openstack volume create --size 1 test-volume-dryrun
Then delete them after verification:

bash
Copy
Edit
openstack port delete test-port-dryrun
openstack volume delete test-volume-dryrun


 volume with a name or ID of 'e355ab4b-a2f5-4a25-a0c8-2523816c9678' exists.
insteadof csubntit is vlan
vsaravan@sjcvl-ghrunner1:~$ openstack network show pro-net-vlan1162                         +---------------------------+--------------------------------------------------------------+
| Field                     | Value                                                        |
+---------------------------+--------------------------------------------------------------+
| admin_state_up            | UP                                                           |
| availability_zone_hints   |                                                              |
| availability_zones        | nova                                                         |
| created_at                | 2025-02-13T22:44:59Z                                         |
| description               | Add description                                              |
| dns_domain                |                                                              |
| id                        | 8ea2d087-bf85-4835-a4e5-54fd51824ce3                         |
| ipv4_address_scope        | None                                                         |
| ipv6_address_scope        | None                                                         |
| is_default                | False                                                        |
| is_vlan_transparent       | None                                                         |
| l2_adjacency              | True                                                         |
| mtu                       | 1500                                                         |
| name                      | pro-net-vlan1162                                             |
| port_security_enabled     | True                                                         |
| project_id                | 59c2d928ef6046069a0175d74dc3dc23                             |
| provider:network_type     | vlan                                                         |
| provider:physical_network | datacentre                                                   |
| provider:segmentation_id  | 1162                                                         |
| qos_policy_id             | None                                                         |
| revision_number           | 3                                                            |
| router:external           | External                                                     |
| segments                  | None                                                         |
| shared                    | False                                                        |
| status                    | ACTIVE                                                       |
| subnets                   | e33be8b2-02e2-41a5-87b5-830ba5d0db7a                         |
| tags                      | BU:IT, Backup:none, BusinessUnit:cloudeng, Environment:Non-  |
|                           | Production, OrganizationName:IT, Sub_BU:VCAD,                |
|                           | Terraform:false, todestroy:false, tosuspend:false            |
| tenant_id                 | 59c2d928ef6046069a0175d74dc3dc23                             |
| updated_at                | 2025-02-13T22:45:14Z                                         |
+---------------------------+--------------------------------------------------------------+
vsaravan@sjcvl-ghrunner1:~$
openstack volume show e355ab4b-a2f5-4a25-a0c8-2523816c9678

this id is sa anapshot and volume command is not working


other than thesae twop everythtung is ggod 

saravan@sjcvl-ghrunner1:~$ openstack volume snapshot show e355ab4b-a2f5-4a25-a0c8-2523816c9678
+--------------------------------------------+--------------------------------------+
| Field                                      | Value                                |
+--------------------------------------------+--------------------------------------+
| created_at                                 | 2025-07-19T05:26:29.000000           |
| description                                |                                      |
| id                                         | e355ab4b-a2f5-4a25-a0c8-2523816c9678 |
| name                                       | large_mem                            |
| os-extended-snapshot-attributes:progress   | 100%                                 |
| os-extended-snapshot-attributes:project_id | 59c2d928ef6046069a0175d74dc3dc23     |
| properties                                 |                                      |
| size                                       | 125                                  |
| status                                     | available                            |
| updated_at                                 | 2025-07-19T05:26:33.000000           |
| volume_id                                  | 60b80fac-0dd2-4c4e-a0dd-f161c7bb1b4a |
+-------------------------------------
















#!/bin/bash

input_value=$1

port_id=$(openstack port create \
  --network 3eb39e89-ac62-4b5b-a313-8d52482cc1f2 \
  --fixed-ip subnet=e5db0db9-bf93-43f4-928a-e46e099fef9e \
  --enable tn02_big_mem_test_${input_value} -f json | jq -r '.id')
echo "Created port: $port_id"

openstack port set \
  --security-group b3455868-8842-4b16-9f35-684e25f25f28 \
  --security-group 1320ddfd-e090-4300-8d9c-c0d10dfaf84b \
  --security-group c741134d-43d3-4419-bb55-ba6e60bead75 \
  --security-group 58269c3b-bd2d-4287-aedc-2e2f2c744c19 \
  $port_id
echo "Security groups set on port"

openstack floating ip create -f json \
  --subnet e33be8b2-02e2-41a5-87b5-830ba5d0db7a \
  --port $port_id pro-net-vlan1162
echo "Floating IP created and associated"

volume_id=$(openstack volume create -f json \
  --type netapp_iscsi \
  --snapshot e355ab4b-a2f5-4a25-a0c8-2523816c9678 \
  --size 125 \
  --bootable tn02_big_mem_test-${input_value} | jq -r '.id')
echo "Created volume: $volume_id"

openstack server create \
  --flavor m1.large \
  --volume $volume_id \
  --security-group b3455868-8842-4b16-9f35-684e25f25f28 \
  --security-group 1320ddfd-e090-4300-8d9c-c0d10dfaf84b \
  --security-group c741134d-43d3-4419-bb55-ba6e60bead75 \
  --security-group 58269c3b-bd2d-4287-aedc-2e2f2c744c19 \
  --port $port_id \
  --key-name c30-drm-keypair \
  --wait tn02_big_mem_test-${input_value}
echo "Server created successfully"

openstack server show tn02_big_mem_test-${input_value} -f value -c OS-EXT-SRV-ATTR:host


















vsaravan@sjcvl-ghrunner1:~$ +-------------------------------------^C
vsaravan@sjcvl-ghrunner1:~$ port_id=$(openstack port create \
>   --network 3eb39e89-ac62-4b5b-a313-8d52482cc1f2 \
>   --fixed-ip subnet=e5db0db9-bf93-43f4-928a-e46e099fef9e \
>   --enable tn02_big_mem_test_${input_value} -f json | jq -r '.id')
vsaravan@sjcvl-ghrunner1:~$ echo "Created port: $port_id"
Created port: 39eeee6a-fdc3-42dd-9813-1895a8867f66
vsaravan@sjcvl-ghrunner1:~$ openstack port set \
>   --security-group b3455868-8842-4b16-9f35-684e25f25f28 \
>   --security-group 1320ddfd-e090-4300-8d9c-c0d10dfaf84b \
>   --security-group c741134d-43d3-4419-bb55-ba6e60bead75 \
>   --security-group 58269c3b-bd2d-4287-aedc-2e2f2c744c19 \
>   $port_id

vsaravan@sjcvl-ghrunner1:~$ echo "Security groups set on port"
Security groups set on port
vsaravan@sjcvl-ghrunner1:~$ openstack floating ip create -f json \
>   --subnet e33be8b2-02e2-41a5-87b5-830ba5d0db7a \
>   --port $port_id pro-net-vlan1162

{
  "created_at": "2025-07-19T06:33:03Z",
  "description": "",
  "dns_domain": "",
  "dns_name": "",
  "fixed_ip_address": "10.154.172.186",
  "floating_ip_address": "10.107.162.79",
  "floating_network_id": "8ea2d087-bf85-4835-a4e5-54fd51824ce3",
  "id": "91a7f0bb-8158-46da-9573-3dad7cfbe71f",
  "name": "10.107.162.79",
  "port_details": {
    "name": "tn02_big_mem_test_",
    "network_id": "3eb39e89-ac62-4b5b-a313-8d52482cc1f2",
    "mac_address": "fa:16:3e:a6:e6:c1",
    "admin_state_up": true,
    "status": "DOWN",
    "device_id": "",
    "device_owner": ""
  },
  "port_forwardings": [],
  "port_id": "39eeee6a-fdc3-42dd-9813-1895a8867f66",
  "project_id": "59c2d928ef6046069a0175d74dc3dc23",
  "qos_policy_id": null,
  "revision_number": 0,
  "router_id": "a6615d27-2a9d-45ba-a3c8-9b452c154b13",
  "status": "DOWN",
  "subnet_id": "e33be8b2-02e2-41a5-87b5-830ba5d0db7a",
  "tags": [],
  "updated_at": "2025-07-19T06:33:03Z"
}
vsaravan@sjcvl-ghrunner1:~$ echo "Floating IP created and associated"
Floating IP created and associated
vsaravan@sjcvl-ghrunner1:~$
vsaravan@sjcvl-ghrunner1:~$ volume_id=$(openstack volume create -f json \
>   --type netapp_iscsi \
>   --snapshot e355ab4b-a2f5-4a25-a0c8-2523816c9678 \
>   --size 125 \
>   --bootable tn02_big_mem_test-${input_value} | jq -r '.id')

Invalid input received: Invalid volume_type provided: 90efbc1b-7dd3-4bef-8da6-c232e5b6956a (requested type is not compatible; recommend omitting the type argument). (HTTP 400) (Request-ID: req-9c357196-1a3d-4370-86ef-9a9a758e38fc)
vsaravan@sjcvl-ghrunner1:~$ echo "Created volume: $volume_id"
Created volume:
vsaravan@s






volume_id=$(openstack volume create -f json \
  --snapshot e355ab4b-a2f5-4a25-a0c8-2523816c9678 \
  --size 125 \
  --bootable tn02_big_mem_test-01 | jq -r '.id')
echo "Created volume: $volume_id"

















Invalid input received: Invalid volume_type provided: 90efbc1b-7dd3-4bef-8da6-c232e5b6956a (requested type is not compatible; recommend omitting the type argument). (HTTP 400) (Request-ID: req-9c357196-1a3d-4370-86ef-9a9a758e38fc)
vsaravan@sjcvl-ghrunner1:~$ echo "Created volume: $volume_id"
Created volume:
vsaravan@sjcvl-ghrunner1:~$ ^C
vsaravan@sjcvl-ghrunner1:~$
vsaravan@sjcvl-ghrunner1:~$ volume_id=$(openstack volume create -f json \
>   --snapshot e355ab4b-a2f5-4a25-a0c8-2523816c9678 \
>   --size 125 \
>   --bootable tn02_big_mem_test-01 | jq -r '.id')

vsaravan@sjcvl-ghrunner1:~$ echo "Created volume: $volume_id"
Created volume: 20189745-bc77-41ee-ab7e-563a3a1b9895
vsaravan@sjcvl-ghrunner1:~$
vsaravan@sjcvl-ghrunner1:~$



vsaravan@sjcvl-ghrunner1:~$ port_id=$(openstack port create \
>   --network 3eb39e89-ac62-4b5b-a313-8d52482cc1f2 \
>   --fixed-ip subnet=e5db0db9-bf93-43f4-928a-e46e099fef9e \
>   --enable tn02_big_mem_test_${input_value} -f json | jq -r '.id')
vsaravan@sjcvl-ghrunner1:~$ echo "Created port: $port_id"
Created port: 39eeee6a-fdc3-42dd-9813-1895a8867f66
vsaravan@sjcvl-ghrunner1:~$ openstack port set \
>   --security-group b3455868-8842-4b16-9f35-684e25f25f28 \
>   --security-group 1320ddfd-e090-4300-8d9c-c0d10dfaf84b \
>   --security-group c741134d-43d3-4419-bb55-ba6e60bead75 \
>   --security-group 58269c3b-bd2d-4287-aedc-2e2f2c744c19 \
>   $port_id

vsaravan@sjcvl-ghrunner1:~$ echo "Security groups set on port"
Security groups set on port
vsaravan@sjcvl-ghrunner1:~$ openstack floating ip create -f json \
>   --subnet e33be8b2-02e2-41a5-87b5-830ba5d0db7a \
>   --port $port_id pro-net-vlan1162

{
  "created_at": "2025-07-19T06:33:03Z",
  "description": "",
  "dns_domain": "",
  "dns_name": "",
  "fixed_ip_address": "10.154.172.186",
  "floating_ip_address": "10.107.162.79",
  "floating_network_id": "8ea2d087-bf85-4835-a4e5-54fd51824ce3",
  "id": "91a7f0bb-8158-46da-9573-3dad7cfbe71f",
  "name": "10.107.162.79",
  "port_details": {
    "name": "tn02_big_mem_test_",
    "network_id": "3eb39e89-ac62-4b5b-a313-8d52482cc1f2",
    "mac_address": "fa:16:3e:a6:e6:c1",
    "admin_state_up": true,
    "status": "DOWN",
    "device_id": "",
    "device_owner": ""
  },
  "port_forwardings": [],
  "port_id": "39eeee6a-fdc3-42dd-9813-1895a8867f66",
  "project_id": "59c2d928ef6046069a0175d74dc3dc23",
  "qos_policy_id": null,
  "revision_number": 0,
  "router_id": "a6615d27-2a9d-45ba-a3c8-9b452c154b13",
  "status": "DOWN",
  "subnet_id": "e33be8b2-02e2-41a5-87b5-830ba5d0db7a",
  "tags": [],
  "updated_at": "2025-07-19T06:33:03Z"
}
vsaravan@sjcvl-ghrunner1:~$ echo "Floating IP created and associated"
Floating IP created and associated
vsaravan@sjcvl-ghrunner1:~$
vsaravan@sjcvl-ghrunner1:~$ volume_id=$(openstack volume create -f json \
>   --type netapp_iscsi \
>   --snapshot e355ab4b-a2f5-4a25-a0c8-2523816c9678 \
>   --size 125 \
>   --bootable tn02_big_mem_test-${input_value} | jq -r '.id')

Invalid input received: Invalid volume_type provided: 90efbc1b-7dd3-4bef-8da6-c232e5b6956a requested type is not compatible; recommend omitting the type argument). (HTTP 400) (Reques-ID: req-9c357196-1a3d-4370-86ef-9a9a758e38fc)
vsaravan@sjcvl-ghrunner1:~$ echo "Created volume: $volume_id"
Created volume:
vsaravan@sjcvl-ghrunner1:~$ ^C
vsaravan@sjcvl-ghrunner1:~$
vsaravan@sjcvl-ghrunner1:~$ volume_id=$(openstack volume create -f json \
>   --snapshot e355ab4b-a2f5-4a25-a0c8-2523816c9678 \
>   --size 125 \
>   --bootable tn02_big_mem_test-01 | jq -r '.id')

vsaravan@sjcvl-ghrunner1:~$ echo "Created volume: $volume_id"
Created volume: 20189745-bc77-41ee-ab7e-563a3a1b9895
vsaravan@sjcvl-ghrunner1:~$
vsaravan@sjcvl-ghrunner1:~$ ^C
vsaravan@sjcvl-ghrunner1:~$



openstack server create \
  --flavor m1.large \
  --volume 20189745-bc77-41ee-ab7e-563a3a1b9895 \
  --security-group b3455868-8842-4b16-9f35-684e25f25f28 \
  --security-group 1320ddfd-e090-4300-8d9c-c0d10dfaf84b \
  --security-group c741134d-43d3-4419-bb55-ba6e60bead75 \
  --security-group 58269c3b-bd2d-4287-aedc-2e2f2c744c19 \
  --port 39eeee6a-fdc3-42dd-9813-1895a8867f66 \
  --key-name c30-drm-keypair \
  --wait tn02_big_mem_test-01



saravan@sjcvl-ghrunner1:~$ openstack server create \
>   --flavor m1.large \
>   --volume 20189745-bc77-41ee-ab7e-563a3a1b9895 \
>   --security-group b3455868-8842-4b16-9f35-684e25f25f28 \
>   --security-group 1320ddfd-e090-4300-8d9c-c0d10dfaf84b \
>   --security-group c741134d-43d3-4419-bb55-ba6e60bead75 \
>   --security-group 58269c3b-bd2d-4287-aedc-2e2f2c744c19 \
>   --port 39eeee6a-fdc3-42dd-9813-1895a8867f66 \
>   --key-name c30-drm-keypair \
>   --wait tn02_big_mem_test-01

+--------------------------------------+--------------------------------------------------+
| Field                                | Value                                            |
+--------------------------------------+--------------------------------------------------+
| OS-DCF:diskConfig                    | MANUAL                                           |
| OS-EXT-AZ:availability_zone          | nova                                             |
| OS-EXT-SRV-ATTR:host                 | tst-overcloud-compute-01.openstack.cadence.com   |
| OS-EXT-SRV-ATTR:hypervisor_hostname  | tst-overcloud-compute-01.openstack.cadence.com   |
| OS-EXT-SRV-ATTR:instance_name        | instance-00000ee9                                |
| OS-EXT-STS:power_state               | Running                                          |
| OS-EXT-STS:task_state                | None                                             |
| OS-EXT-STS:vm_state                  | active                                           |
| OS-SRV-USG:launched_at               | 2025-07-19T06:45:51.000000                       |
| OS-SRV-USG:terminated_at             | None                                             |
| accessIPv4                           |                                                  |
| accessIPv6                           |                                                  |
| addresses                            | c30-tn-test-tn-02-network=10.107.162.79,         |
|                                      | 10.154.172.186                                   |
| adminPass                            | XsQeU9eZcFbP                                     |
| config_drive                         |                                                  |
| created                              | 2025-07-19T06:45:39Z                             |
| flavor                               | m1.large (d730eb29-69d2-41c7-b412-9c8d909b9aab)  |
| hostId                               | e33a25b6c552fecbb1171d2294c17e26e329889ee3ffbfeb |
|                                      | 163cad55                                         |
| id                                   | 3aabe94a-a7c5-4d72-b348-aa17ebffbf3b             |
| image                                | N/A (booted from volume)                         |
| key_name                             | c30-drm-keypair                                  |
| name                                 | tn02_big_mem_test-01                             |
| os-extended-volumes:volumes_attached | [{'id': '20189745-bc77-41ee-ab7e-563a3a1b9895'}] |
| progress                             | 0                                                |
| project_id                           | 59c2d928ef6046069a0175d74dc3dc23                 |
| properties                           |                                                  |
| security_groups                      | name='c30-tn-test-tn-02-Chm-AccessFromUtlSvr-sg' |
|                                      | name='default'                                   |
|                                      | name='c30-tn-test-tn-02-PrivateSG-sg'            |
|                                      | name='c30-tn-test-tn-02-CLA-SG-sg'               |
|                                      | name='c30-tn-test-tn-02-Platform-SG-sg'          |
| status                               | ACTIVE                                           |
| updated                              | 2025-07-19T06:45:51Z                             |
| user_id                              | 64a837e9a22b4edf90375c7182a9f297                 |
+--------------------------------------+--------------------------------------------------+
vs

vsaravan@sjcvl-ghrunner1:~$ ^C
vsaravan@sjcvl-ghrunner1:~$ openstack aggregate show high-memory-hosts
+-------------------+------------------------------------------------+
| Field             | Value                                          |
+-------------------+------------------------------------------------+
| availability_zone | None                                           |
| created_at        | 2025-07-17T17:42:18.000000                     |
| deleted_at        | None                                           |
| hosts             | tst-overcloud-compute-01.openstack.cadence.com |
| id                | 1                                              |
| is_deleted        | False                                          |
| name              | high-memory-hosts                              |
| properties        | host_type='highmem'                            |
| updated_at        | None                                           |
| uuid              | e490ca7a-d613-4e6b-bd52-37f3d18d0fcd           |
+-------------------+------------








saravan@sjcvl-ghrunner1:~$ openstack server create \
>   --flavor m1.large \
>   --volume 20189745-bc77-41ee-ab7e-563a3a1b9895 \
>   --security-group b3455868-8842-4b16-9f35-684e25f25f28 \
>   --security-group 1320ddfd-e090-4300-8d9c-c0d10dfaf84b \
>   --security-group c741134d-43d3-4419-bb55-ba6e60bead75 \
>   --security-group 58269c3b-bd2d-4287-aedc-2e2f2c744c19 \
>   --port 39eeee6a-fdc3-42dd-9813-1895a8867f66 \
>   --key-name c30-drm-keypair \
>   --wait tn02_big_mem_test-01

+--------------------------------------+--------------------------------------------------+
| Field                                | Value                                            |
+--------------------------------------+--------------------------------------------------+
| OS-DCF:diskConfig                    | MANUAL                                           |
| OS-EXT-AZ:availability_zone          | nova                                             |
| OS-EXT-SRV-ATTR:host                 | tst-overcloud-compute-01.openstack.cadence.com   |
| OS-EXT-SRV-ATTR:hypervisor_hostname  | tst-overcloud-compute-01.openstack.cadence.com   |
| OS-EXT-SRV-ATTR:instance_name        | instance-00000ee9                                |
| OS-EXT-STS:power_state               | Running                                          |
| OS-EXT-STS:task_state                | None                                             |
| OS-EXT-STS:vm_state                  | active                                           |
| OS-SRV-USG:launched_at               | 2025-07-19T06:45:51.000000                       |
| OS-SRV-USG:terminated_at             | None                                             |
| accessIPv4                           |                                                  |
| accessIPv6                           |                                                  |
| addresses                            | c30-tn-test-tn-02-network=10.107.162.79,         |
|                                      | 10.154.172.186                                   |
| adminPass                            | XsQeU9eZcFbP                                     |
| config_drive                         |                                                  |
| created                              | 2025-07-19T06:45:39Z                             |
| flavor                               | m1.large (d730eb29-69d2-41c7-b412-9c8d909b9aab)  |
| hostId                               | e33a25b6c552fecbb1171d2294c17e26e329889ee3ffbfeb |
|                                      | 163cad55                                         |
| id                                   | 3aabe94a-a7c5-4d72-b348-aa17ebffbf3b             |
| image                                | N/A (booted from volume)                         |
| key_name                             | c30-drm-keypair                                  |
| name                                 | tn02_big_mem_test-01                             |
| os-extended-volumes:volumes_attached | [{'id': '20189745-bc77-41ee-ab7e-563a3a1b9895'}] |
| progress                             | 0                                                |
| project_id                           | 59c2d928ef6046069a0175d74dc3dc23                 |
| properties                           |                                                  |
| security_groups                      | name='c30-tn-test-tn-02-Chm-AccessFromUtlSvr-sg' |
|                                      | name='default'                                   |
|                                      | name='c30-tn-test-tn-02-PrivateSG-sg'            |
|                                      | name='c30-tn-test-tn-02-CLA-SG-sg'               |
|                                      | name='c30-tn-test-tn-02-Platform-SG-sg'          |
| status                               | ACTIVE                                           |
| updated                              | 2025-07-19T06:45:51Z                             |
| user_id                              | 64a837e9a22b4edf90375c7182a9f297                 |
+--------------------------------------+-----------------------------------------






vsaravan@sjcvl-ghrunner1:~$ openstack aggregate show high-memory-hosts
+-------------------+------------------------------------------------+
| Field             | Value                                          |
+-------------------+------------------------------------------------+
| availability_zone | None                                           |
| created_at        | 2025-07-17T17:42:18.000000                     |
| deleted_at        | None                                           |
| hosts             | tst-overcloud-compute-01.openstack.cadence.com |
| id                | 1                                              |
| is_deleted        | False                                          |
| name              | high-memory-hosts                              |
| properties        | host_type='highmem'                            |
| updated_at        | None                                           |
| uuid              | e490ca7a-d613-4e6b-bd52-37f3d18d0fcd           |
+-------------------+------------------------------------------------+
vsaravan@sjcvl-ghrunner1:~$ ^C
vsaravan@sjcvl-ghrunner1:~$





✅ Step 1: Create port for lowmem test
bash
Copy
Edit
port_id=$(openstack port create \
  --network 3eb39e89-ac62-4b5b-a313-8d52482cc1f2 \
  --fixed-ip subnet=e5db0db9-bf93-43f4-928a-e46e099fef9e \
  --enable test-lowmem-port -f json | jq -r '.id')
echo "Created port: $port_id"
✅ Step 2: Assign security groups
bash
Copy
Edit
openstack port set \
  --security-group b3455868-8842-4b16-9f35-684e25f25f28 \
  --security-group 1320ddfd-e090-4300-8d9c-c0d10dfaf84b \
  --security-group c741134d-43d3-4419-bb55-ba6e60bead75 \
  --security-group 58269c3b-bd2d-4287-aedc-2e2f2c744c19 \
  $port_id
echo "Security groups set on port"
✅ Step 3: Create floating IP and associate
bash
Copy
Edit
openstack floating ip create -f json \
  --subnet e33be8b2-02e2-41a5-87b5-830ba5d0db7a \
  --port $port_id pro-net-vlan1162
echo "Floating IP created and associated"
✅ Step 4: Create a bootable volume from snapshot
You can reuse the same snapshot (large_mem) or any other snapshot you want.
Here I’ll use the same snapshot ID:

bash
Copy
Edit
volume_id=$(openstack volume create -f json \
  --snapshot e355ab4b-a2f5-4a25-a0c8-2523816c9678 \
  --size 125 \
  --bootable test-lowmem-vol | jq -r '.id')
echo "Created volume: $volume_id"
✅ Step 5: Create the server using c2m4 flavor
bash
Copy
Edit
openstack server create \
  --flavor c2m4 \
  --volume $volume_id \
  --security-group b3455868-8842-4b16-9f35-684e25f25f28 \
  --security-group 1320ddfd-e090-4300-8d9c-c0d10dfaf84b \
  --security-group c741134d-43d3-4419-bb55-ba6e60bead75 \
  --security-group 58269c3b-bd2d-4287-aedc-2e2f2c744c19 \
  --port $port_id \
  --key-name c30-drm-keypair \
  --wait test-lowmem-vm
✅ Step 6: Verify which compute node it landed on
bash
Copy
Edit
openstack server show test-lowmem-vm -f value -c OS-EXT-SRV-ATTR:host
Expected result:
Since flavor c2m4 is tagged with host_type=smallmem, the scheduler should pick a host from low-memory-hosts aggregate — which, per your notes, includes tst-overcloud-compute-02.

🚀 Let’s do it step by step
Start with Step 1 (port creation) and paste me the output, then I’ll guide you through the rest exactly as before.

Ready when you are!









Ask ChatGPT
You said:
 so did you mapeed iot right


ChatGPT said:
Yes — I mapped it carefully for the low‑memory test using your same environment values.
Here’s the full mapping I used and double‑checked before writing those commands:

Resource	Value used
Network ID	3eb39e89-ac62-4b5b-a313-8d52482cc1f2
Subnet ID	e5db0db9-bf93-43f4-928a-e46e099fef9e
Floating network	pro-net-vlan1162 (ID 8ea2d087-bf85-4835-a4e5-54fd51824ce3)
Floating subnet	e33be8b2-02e2-41a5-87b5-830ba5d0db7a
Security Groups	b3455868-8842-4b16-9f35-684e25f25f28, 1320ddfd-e090-4300-8d9c-c0d10dfaf84b, c741134d-43d3-4419-bb55-ba6e60bead75, 58269c3b-bd2d-4287-aedc-2e2f2c744c19
Keypair	c30-drm-keypair
Snapshot ID for volume	e355ab4b-a2f5-4a25-a0c8-2523816c9678 (large_mem snapshot)
Flavor for low‑mem test	c2m4 (tagged with host_type=smallmem)
Expected host aggregate	low-memory-hosts → contains tst-overcloud-compute-02

✔️ So yes — all values are mapped consistently with your previous setup, except now we are using:

Flavor: c2m4

VM name: test-lowmem-vm

Volume name: test-lowmem-vol

Port name: test-lowmem-port

These new names keep them separate from your high‑mem test.

✅ Next step
If you’re ready, start with:

bash
Copy
Edit
openstack port create \
  --network 3eb39e89-ac62-4b5b-a313-8d52482cc1f2 \
  --fixed-ip subnet=e5db0db9-bf93-43f4-928a-e46e099fef9e \
  --enable test-lowmem-port -f json | jq -r '.id'
Paste the output here, and we’ll proceed step by step exactly like before.
Let’s go when you’re ready! ✅








vsaravan@sjcvl-ghrunner1:~$ port_id=$(openstack port create \
>   --network 3eb39e89-ac62-4b5b-a313-8d52482cc1f2 \
>   --fixed-ip subnet=e5db0db9-bf93-43f4-928a-e46e099fef9e \
>   --enable test-lowmem-port -f json | jq -r '.id')
vsaravan@sjcvl-ghrunner1:~$ echo "Created port: $port_id"
Created port: c2ea5a2b-e536-4d5a-96a8-d01bfd43630c
vsaravan@sjcvl-ghrunner1:~$ openstack port set \
>   --security-group b3455868-8842-4b16-9f35-684e25f25f28 \
>   --security-group 1320ddfd-e090-4300-8d9c-c0d10dfaf84b \
>   --security-group c741134d-43d3-4419-bb55-ba6e60bead75 \
>   --security-group 58269c3b-bd2d-4287-aedc-2e2f2c744c19 \
>   $port_id
vsaravan@sjcvl-ghrunner1:~$ echo "Security groups set on port"
Security groups set on port
vsaravan@sjcvl-ghrunner1:~$ openstack floating ip create -f json \
>   --subnet e33be8b2-02e2-41a5-87b5-830ba5d0db7a \
>   --port $port_id pro-net-vlan1162

{
  "created_at": "2025-07-19T07:36:15Z",
  "description": "",
  "dns_domain": "",
  "dns_name": "",
  "fixed_ip_address": "10.154.172.240",
  "floating_ip_address": "10.107.163.51",
  "floating_network_id": "8ea2d087-bf85-4835-a4e5-54fd51824ce3",
  "id": "3332fddb-8f68-42ea-80df-a0699844baa2",
  "name": "10.107.163.51",
  "port_details": {
    "name": "test-lowmem-port",
    "network_id": "3eb39e89-ac62-4b5b-a313-8d52482cc1f2",
    "mac_address": "fa:16:3e:a6:17:3a",
    "admin_state_up": true,
    "status": "DOWN",
    "device_id": "",
    "device_owner": ""
  },
  "port_forwardings": [],
  "port_id": "c2ea5a2b-e536-4d5a-96a8-d01bfd43630c",
  "project_id": "59c2d928ef6046069a0175d74dc3dc23",
  "qos_policy_id": null,
  "revision_number": 0,
  "router_id": "a6615d27-2a9d-45ba-a3c8-9b452c154b13",
  "status": "DOWN",
  "subnet_id": "e33be8b2-02e2-41a5-87b5-830ba5d0db7a",
  "tags": [],
  "updated_at": "2025-07-19T07:36:15Z"
}
vsaravan@sjcvl-ghrunner1:~$ echo "Floating IP created and associated"
Floating IP created and associated
vsaravan@sjcvl-ghrunner1:~$ volume_id=$(openstack volume create -f json \
>   --snapshot e355ab4b-a2f5-4a25-a0c8-2523816c9678 \
>   --size 125 \
>   --bootable test-lowmem-vol | jq -r '.id')

vsaravan@sjcvl-ghrunner1:~$ echo "Created volume: $volume_id"
Created volume: 568a80a0-249f-40d8-93c0-649d58631f8e
vsaravan@sjcvl-ghrunner1:~$ openstack server create \
>   --flavor c2m4 \
>   --volume $volume_id \
>   --security-group b3455868-8842-4b16-9f35-684e25f25f28 \
>   --security-group 1320ddfd-e090-4300-8d9c-c0d10dfaf84b \
>   --security-group c741134d-43d3-4419-bb55-ba6e60bead75 \
>   --security-group 58269c3b-bd2d-4287-aedc-2e2f2c744c19 \
>   --port $port_id \
>   --key-name c30-drm-keypair \
>   --wait test-lowmem-vm
Error creating server: test-lowmem-vm



